# RAG 시스템 구조 및 작동 원리

## 개요
이 문서는 볼보 사용자 매뉴얼을 활용한 RAG(Retrieval-Augmented Generation) 시스템의 구조와 작동 방식을 설명합니다.

## 시스템 구성 요소

### 1. 사용자 (USER)
- **역할**: 자연어로 질문을 입력
- **예시 질문**: "자동 브레이크 기능을 끄는 방법은?"

### 2. 임베딩 모델 (EMBEDDING MODEL)
- **기능**: 텍스트를 벡터(숫자 배열)로 변환
- **두 가지 용도**:
  - 사용자 질문 벡터화
  - 문서 내용 벡터화

### 3. 벡터 데이터베이스 (VECTOR DATABASE)
- **후보**: Weaviate 또는 Qdrant
- **저장 내용**:
  - 문서 조각들의 임베딩 벡터
  - 메타데이터 (문서 제목, 페이지, 카테고리 등)
- **핵심 기능**: 유사도 검색을 통한 관련 문서 빠른 검색

### 4. 생성형 AI 모델 (GENERATIVE MODEL)
- **예시**: GPT, Claude, Llama 등
- **역할**: 검색된 컨텍스트를 바탕으로 정확한 답변 생성

## 시스템 작동 과정

### 단계 1: 데이터 준비 (사전 처리)
1. **문서 수집**: 볼보 사용자 매뉴얼 전체를 수집
2. **문서 분할**: 큰 문서를 작은 의미 단위로 분할
3. **벡터화**: 각 문서 조각을 임베딩 모델로 벡터 변환
4. **저장**: 벡터와 메타데이터를 벡터 데이터베이스에 저장

### 단계 2: 실시간 질의 응답
1. **질문 입력**: 사용자가 자연어로 질문
2. **질문 벡터화**: 임베딩 모델이 질문을 벡터로 변환
3. **유사도 검색**: 벡터 데이터베이스에서 가장 관련성 높은 문서 조각들 검색
4. **컨텍스트 구성**: 검색된 문서 조각들을 질문과 함께 생성형 AI에 전달
5. **답변 생성**: AI가 컨텍스트를 참고하여 정확한 답변 생성

## 예시 시나리오

### 질문
"자동 브레이크 기능을 비활성화하는 방법이 궁금해요"

### 시스템 처리 과정
1. **벡터 검색**: "자동 브레이크", "비활성화", "설정" 관련 벡터 검색
2. **문서 조각 발견**:
   - "RAB(Rear Auto Brake) 설정 방법"
   - "CTA(Cross Traffic Alert) 비활성화"
   - "주차 카메라 화면 설정"
3. **답변 생성**: 발견된 정보를 종합하여 단계별 설명 제공

### 최종 답변
"운전자는 RAB(Rear Auto Brake)와 CTA(Cross Traffic Alert)를 비활성화할 수 있습니다. 경고 신호는 별도로 비활성화할 수 있으며, 주차 카메라 화면의 해당 버튼을 통해 자동 브레이크를 활성화하거나 비활성화할 수 있습니다."

## Weaviate vs Qdrant 선택 기준

### Weaviate 선택 시
- 다양한 AI 모델과의 쉬운 통합
- GraphQL을 통한 복잡한 쿼리
- 클라우드 서비스 활용

### Qdrant 선택 시
- 높은 성능과 속도 요구
- 메모리 효율성 중시
- REST API 선호

## 시스템의 장점

1. **정확성**: 실제 매뉴얼 내용을 기반으로 한 신뢰할 수 있는 답변
2. **최신성**: 매뉴얼 업데이트 시 벡터 데이터베이스만 갱신하면 됨
3. **효율성**: 전체 매뉴얼을 읽지 않고도 관련 정보만 빠르게 검색
4. **사용성**: 자연어 질문으로 쉽게 원하는 정보 획득

## 구현 시 고려사항

- **청킹 전략**: 문서를 어떤 단위로 나눌지 결정
- **임베딩 모델 선택**: 한국어 지원 여부, 성능 등 고려
- **벡터 차원수**: 정확도와 성능의 균형점 찾기
- **메타데이터 설계**: 효과적인 필터링을 위한 정보 구조화